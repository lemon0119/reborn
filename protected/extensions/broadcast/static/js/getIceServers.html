<script>
function createCORSRequest(method, url) {
    var xhr = new XMLHttpRequest();
    if ("withCredentials" in xhr) {
        xhr.open(method, url, true);
    } else if (typeof XDomainRequest != "undefined") {
        xhr = new XDomainRequest();
        xhr.open(method, url);
    } else {
        xhr = null;
    }
    return xhr;
}
var url = 'https://api.xirsys.com/getIceServers';
var xhr = createCORSRequest('POST', url);
xhr.onload = function () {
    window.parent.postMessage({
        iceServers: JSON.parse(xhr.responseText).d.iceServers
    }, '*');
};
xhr.onerror = function () {
    console.error('Woops, there was an error making xhr request.');
};
xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
window.addEventListener('message', function (event) {
    if (!event.data || typeof event.data !== 'string') return;
    if(event.data == 'get-ice-servers') {
        xhr.send('ident=muazkh&secret=6f52bc67-4c2d-445c-ac5d-6024fe7975fb&domain=4dbefa02675a4cdb7fc25d009516b060a84a3b4b.googledrive.com&application=default&room=default&secure=1');
    }
});
</script>
